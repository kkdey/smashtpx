pooled_data[,m] = tapply(reads_table[,m], factor(tissue_labels), sum)
}
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
one_gene_data <- get(load("../data/reads_all_2_55459038_55462989.Robj"))
length(one_gene_data)
reads_table <- as.numeric()
tissue_labels <- as.numeric();
for(m in 1:8){
reads <- one_gene_data[[m]][[2]]
tissue_labels <- c(tissue_labels, rep(m,dim(reads)[1]))
reads_table <- rbind(reads_table, reads);
}
pooled_data <- matrix(0, 8, dim(reads_table)[2])
for(m in 1:dim(pooled_data)[2]){
pooled_data[,m] = tapply(reads_table[,m], factor(tissue_labels), sum)
}
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
one_gene_data <- get(load("../data/reads_all_5_150399998_150408554.Robj"))
length(one_gene_data)
reads_table <- as.numeric()
tissue_labels <- as.numeric();
for(m in 1:8){
reads <- one_gene_data[[m]][[2]]
tissue_labels <- c(tissue_labels, rep(m,dim(reads)[1]))
reads_table <- rbind(reads_table, reads);
}
pooled_data <- matrix(0, 8, dim(reads_table)[2])
for(m in 1:dim(pooled_data)[2]){
pooled_data[,m] = tapply(reads_table[,m], factor(tissue_labels), sum)
}
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
library(gplots)
library(fields)
rownames(pooled_data) = 1:8
colnames(pooled_data) = 1:dim(pooled_data)[2]
pooled_data_1 <- t(apply(pooled_data, 1, function(x) return(x/sum(x))))
# image.plot(t(pooled_data), col=rainbow(100),  breaks = seq(0,600, length.out=101),
#            trace="none",cexRow=0.3, cexCol=0.3)
#
# library(cape)
# col1 = c(rgb(seq(0,1,length=5),1,seq(0,1,length=5)),rgb(1,seq(1,0,length=5),seq(1,0,length=5)))
myImagePlot(pooled_data_1)
topic_clus <- maptpx::topics(pooled_data, K=3, tol=10)
omega <- topic_clus$omega
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(1:max(tissue_labels),
levels=1:max(tissue_labels)) )
rownames(omega) <- annotation$sample_id
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
plot(topic_clus$theta[,1], col=cols1[1], type="l")
lines(topic_clus$theta[,2], col=cols1[2])
lines(topic_clus$theta[,3], col=cols1[3])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
topic_clus <- maptpx::topics(pooled_data, K=2, tol=10)
omega <- topic_clus$omega
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(1:max(tissue_labels),
levels=1:max(tissue_labels)) )
rownames(omega) <- annotation$sample_id
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
plot(topic_clus$theta[,1], col=cols1[1], type="l")
lines(topic_clus$theta[,2], col=cols1[2])
lines(topic_clus$theta[,3], col=cols1[3])
one_gene_data
one_gene_data[[1]]
one_gene_data[[9]]
one_gene_data[[8]]
one_gene_data[[7]]
one_gene_data[[10]]
names(one_gene_data[[2]])
names(one_gene_data[[2]][1:5,1:5]
)
one_gene_data[[2]][1:5,1:5]
dim(one_gene_data[[2]])
one_gene_data[[2]]
one_gene_data[[2]][[1]]
one_gene_data[[2]][[2]]
one_gene_data[[2]][[3]]
one_gene_data[[8]][[1]]
one_gene_data[[3]][[1]]
one_gene_data[[4]][[1]]
one_gene_data[[5]][[1]]
one_gene_data[[6]][[1]]
one_gene_data[[7]][[1]]
one_gene_data[[7]][[3]]
one_gene_data[[3]][[1]]
one_gene_data[[8]][[1]]
one_gene_data[[9]][[1]]
one_gene_data[[10]][[1]]
one_gene_data <- get(load("../data/reads_all_11_61731756_61735132.Robj"))
length(one_gene_data)
reads_table <- as.numeric()
tissue_labels <- as.numeric();
for(m in 1:8){
reads <- one_gene_data[[m]][[2]]
tissue_labels <- c(tissue_labels, rep(m,dim(reads)[1]))
reads_table <- rbind(reads_table, reads);
}
pooled_data <- matrix(0, 8, dim(reads_table)[2])
for(m in 1:dim(pooled_data)[2]){
pooled_data[,m] = tapply(reads_table[,m], factor(tissue_labels), sum)
}
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
library(gplots)
library(fields)
rownames(pooled_data) = 1:8
colnames(pooled_data) = 1:dim(pooled_data)[2]
pooled_data_1 <- t(apply(pooled_data, 1, function(x) return(x/sum(x))))
# image.plot(t(pooled_data), col=rainbow(100),  breaks = seq(0,600, length.out=101),
#            trace="none",cexRow=0.3, cexCol=0.3)
#
# library(cape)
# col1 = c(rgb(seq(0,1,length=5),1,seq(0,1,length=5)),rgb(1,seq(1,0,length=5),seq(1,0,length=5)))
myImagePlot(pooled_data_1)
topic_clus <- maptpx::topics(pooled_data, K=2, tol=10)
omega <- topic_clus$omega
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(1:max(tissue_labels),
levels=1:max(tissue_labels)) )
rownames(omega) <- annotation$sample_id
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
plot(topic_clus$theta[,1], col=cols1[1], type="l")
lines(topic_clus$theta[,2], col=cols1[2])
lines(topic_clus$theta[,3], col=cols1[3])
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
one_gene_data <- get(load("../data/reads_all_11_809935_812876.Robj"))
length(one_gene_data)
reads_table <- as.numeric()
tissue_labels <- as.numeric();
for(m in 1:8){
reads <- one_gene_data[[m]][[2]]
tissue_labels <- c(tissue_labels, rep(m,dim(reads)[1]))
reads_table <- rbind(reads_table, reads);
}
pooled_data <- matrix(0, 8, dim(reads_table)[2])
for(m in 1:dim(pooled_data)[2]){
pooled_data[,m] = tapply(reads_table[,m], factor(tissue_labels), sum)
}
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
one_gene_data <- get(load("../data/reads_all_11_17095938_17099220.Robj"))
length(one_gene_data)
reads_table <- as.numeric()
tissue_labels <- as.numeric();
for(m in 1:8){
reads <- one_gene_data[[m]][[2]]
tissue_labels <- c(tissue_labels, rep(m,dim(reads)[1]))
reads_table <- rbind(reads_table, reads);
}
pooled_data <- matrix(0, 8, dim(reads_table)[2])
for(m in 1:dim(pooled_data)[2]){
pooled_data[,m] = tapply(reads_table[,m], factor(tissue_labels), sum)
}
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
par(mfrow=c(4,2))
for(m in 1:4){
plot(pooled_data[m,], col=cols1[1], type="l")
}
plot(pooled_data[3,], col=cols1[1], type="l")
par(mfrow=c(4,2))
for(m in 1:4){
plot(pooled_data[3,], col=cols1[1], type="l")
}
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[3,], col=cols1[1], type="l")
}
library(gplots)
library(fields)
rownames(pooled_data) = 1:8
colnames(pooled_data) = 1:dim(pooled_data)[2]
pooled_data_1 <- t(apply(pooled_data, 1, function(x) return(x/sum(x))))
# image.plot(t(pooled_data), col=rainbow(100),  breaks = seq(0,600, length.out=101),
#            trace="none",cexRow=0.3, cexCol=0.3)
#
# library(cape)
# col1 = c(rgb(seq(0,1,length=5),1,seq(0,1,length=5)),rgb(1,seq(1,0,length=5),seq(1,0,length=5)))
myImagePlot(pooled_data_1)
topic_clus <- maptpx::topics(pooled_data, K=2, tol=10)
omega <- topic_clus$omega
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(1:max(tissue_labels),
levels=1:max(tissue_labels)) )
rownames(omega) <- annotation$sample_id
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
plot(topic_clus$theta[,1], col=cols1[1], type="l")
lines(topic_clus$theta[,2], col=cols1[2])
lines(topic_clus$theta[,3], col=cols1[3])
omega
topic_clus <- maptpx::topics(pooled_data, K=3, tol=10)
omega <- topic_clus$omega
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(1:max(tissue_labels),
levels=1:max(tissue_labels)) )
rownames(omega) <- annotation$sample_id
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
plot(topic_clus$theta[,1], col=cols1[1], type="l")
lines(topic_clus$theta[,2], col=cols1[2])
lines(topic_clus$theta[,3], col=cols1[3])
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
one_gene_data[[3]][1]
one_gene_data[[5]][1]
one_gene_data[[9][1]
one_gene_data[[9]][1]
one_gene_data <- get(load("../data/reads_all_5_150399998_150408554.Robj"))
length(one_gene_data)
reads_table <- as.numeric()
tissue_labels <- as.numeric();
for(m in 1:8){
reads <- one_gene_data[[m]][[2]]
tissue_labels <- c(tissue_labels, rep(m,dim(reads)[1]))
reads_table <- rbind(reads_table, reads);
}
pooled_data <- matrix(0, 8, dim(reads_table)[2])
for(m in 1:dim(pooled_data)[2]){
pooled_data[,m] = tapply(reads_table[,m], factor(tissue_labels), sum)
}
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
library(gplots)
library(fields)
rownames(pooled_data) = 1:8
colnames(pooled_data) = 1:dim(pooled_data)[2]
pooled_data_1 <- t(apply(pooled_data, 1, function(x) return(x/sum(x))))
# image.plot(t(pooled_data), col=rainbow(100),  breaks = seq(0,600, length.out=101),
#            trace="none",cexRow=0.3, cexCol=0.3)
#
# library(cape)
# col1 = c(rgb(seq(0,1,length=5),1,seq(0,1,length=5)),rgb(1,seq(1,0,length=5),seq(1,0,length=5)))
myImagePlot(pooled_data_1)
topic_clus <- maptpx::topics(pooled_data, K=4, tol=10)
omega <- topic_clus$omega
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(1:max(tissue_labels),
levels=1:max(tissue_labels)) )
rownames(omega) <- annotation$sample_id
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
dim(pooled_data)
topic_clus <- maptpx::topics(pooled_data, K=2, tol=10)
omega <- topic_clus$omega
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(1:max(tissue_labels),
levels=1:max(tissue_labels)) )
rownames(omega) <- annotation$sample_id
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
plot(topic_clus$theta[,1], col=cols1[1], type="l")
lines(topic_clus$theta[,2], col=cols1[2])
lines(topic_clus$theta[,3], col=cols1[3])
topic_clus <- maptpx::topics(pooled_data, K=3, tol=10)
omega <- topic_clus$omega
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(1:max(tissue_labels),
levels=1:max(tissue_labels)) )
rownames(omega) <- annotation$sample_id
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
plot(topic_clus$theta[,1], col=cols1[1], type="l")
lines(topic_clus$theta[,2], col=cols1[2])
lines(topic_clus$theta[,3], col=cols1[3])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
one_gene_data <- get(load("../data/reads_all_10_73576054_73611082.Robj"))
length(one_gene_data)
reads_table <- as.numeric()
tissue_labels <- as.numeric();
for(m in 1:8){
reads <- one_gene_data[[m]][[2]]
tissue_labels <- c(tissue_labels, rep(m,dim(reads)[1]))
reads_table <- rbind(reads_table, reads);
}
pooled_data <- matrix(0, 8, dim(reads_table)[2])
for(m in 1:dim(pooled_data)[2]){
pooled_data[,m] = tapply(reads_table[,m], factor(tissue_labels), sum)
}
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
library(gplots)
library(fields)
rownames(pooled_data) = 1:8
colnames(pooled_data) = 1:dim(pooled_data)[2]
pooled_data_1 <- t(apply(pooled_data, 1, function(x) return(x/sum(x))))
# image.plot(t(pooled_data), col=rainbow(100),  breaks = seq(0,600, length.out=101),
#            trace="none",cexRow=0.3, cexCol=0.3)
#
# library(cape)
# col1 = c(rgb(seq(0,1,length=5),1,seq(0,1,length=5)),rgb(1,seq(1,0,length=5),seq(1,0,length=5)))
myImagePlot(pooled_data_1)
topic_clus <- maptpx::topics(pooled_data, K=3, tol=10)
omega <- topic_clus$omega
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(1:max(tissue_labels),
levels=1:max(tissue_labels)) )
rownames(omega) <- annotation$sample_id
cols1 <- c(rev(RColorBrewer::brewer.pal(12, "Paired"))[c(3,4,7,8,11,12,5,6,9,10)],
RColorBrewer::brewer.pal(12, "Set3")[c(1,2,5,8,9)],
RColorBrewer::brewer.pal(9, "Set1")[c(9,7)],
RColorBrewer::brewer.pal(8, "Dark2")[c(3,4,8)])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
plot(topic_clus$theta[,1], col=cols1[1], type="l")
lines(topic_clus$theta[,2], col=cols1[2])
lines(topic_clus$theta[,3], col=cols1[3])
CountClust::StructureGGplot(omega = omega,
annotation= annotation,
palette = cols1,
yaxis_label = "",
order_sample = FALSE,
split_line = list(split_lwd = .1,
split_col = "white"),
axis_tick = list(axis_ticks_length = .1,
axis_ticks_lwd_y = .1,
axis_ticks_lwd_x = .1,
axis_label_size = 5,
axis_label_face="bold"))
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
par(mfrow=c(4,2))
for(m in 1:8){
plot(pooled_data[m,], col=cols1[1], type="l")
}
